name: Test Outputs
on: pull_request

jobs:
  save-outputs:
    name: Save Outputs
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    runs-on: ubuntu-latest
    outputs:
      linux: ${{ steps.output.outputs.ubuntu-latest }}
      windows: ${{ steps.output.outputs.windows-latest }}
      mac: ${{ steps.output.outputs.macos-latest }}
    steps:
      - name: Dummy
        id: dummy
        run: |
          if [ "${{matrix.os}}" == "ubuntu-latest" ]; then
            exit &
          fi
          exit 0
      - name: Output
        id: output
        if: always()
        run: |
          echo "${{matrix.os}}=${{steps.dummy.outcome}}" >> $GITHUB_OUTPUT

  retrieve-outputs:
    name: Print Outputs
    runs-on: ubuntu-latest
    needs: save-outputs
    steps:
      - name: Print Outputs
        run: echo "${{ toJSON(needs) }}"

name: "Setup Env for Coin Tester"
description: "Installs deps, pulls docker, builds modules"
runs:
  using: "composite"
  steps:
    # Pull `0.25.9` to match the version used by E2E tests
    - run: docker pull ghcr.io/ledgerhq/speculos:0.25.9
      shell: bash

    # Map `0.25.9` tag to `latest` in order to preserve local images
    - run: docker tag ghcr.io/ledgerhq/speculos:0.25.9 speculos:latest
      shell: bash

    - run: pnpm i --filter="!./apps/**"
      shell: bash

    - run: pnpm build:coin-tester-modules:deps
      shell: bash

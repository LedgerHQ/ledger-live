"use strict";const __rslib_import_meta_url__="u"<typeof document?new(require("url".replace("",""))).URL("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("main.js",document.baseURI).href;exports.ids=["769"],exports.modules={"../../../node_modules/.pnpm/@aws-sdk+credential-provider-sso@3.651.1_@aws-sdk+client-sso-oidc@3.651.1_@aws-sdk+client-sts@3.651.1_/node_modules/@aws-sdk/credential-provider-sso/dist-es/index.js"(e,s,o){o.d(s,{fromSSO:()=>g});var t=o("../../../node_modules/.pnpm/@smithy+property-provider@3.1.4/node_modules/@smithy/property-provider/dist-es/index.js"),i=o("../../../node_modules/.pnpm/@smithy+shared-ini-file-loader@3.1.5/node_modules/@smithy/shared-ini-file-loader/dist-es/index.js");let n="To refresh this SSO session run 'aws sso login' with the corresponding profile.",r={},a=async e=>{let{SSOOIDCClient:s}=await o.e("914").then(o.bind(o,"../../../node_modules/.pnpm/@aws-sdk+client-sso-oidc@3.651.1_@aws-sdk+client-sts@3.651.1/node_modules/@aws-sdk/client-sso-oidc/dist-es/index.js"));if(r[e])return r[e];let t=new s({region:e});return r[e]=t,t},l=async(e,s)=>{let{CreateTokenCommand:t}=await o.e("914").then(o.bind(o,"../../../node_modules/.pnpm/@aws-sdk+client-sso-oidc@3.651.1_@aws-sdk+client-sts@3.651.1/node_modules/@aws-sdk/client-sso-oidc/dist-es/index.js"));return(await a(s)).send(new t({clientId:e.clientId,clientSecret:e.clientSecret,refreshToken:e.refreshToken,grantType:"refresh_token"}))},d=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new t.Jh(`Token is expired. ${n}`,!1)},c=(e,s,o=!1)=>{if(void 0===s)throw new t.Jh(`Value not present for '${e}' in SSO Token${o?". Cannot refresh":""}. ${n}`,!1)},{writeFile:w}=o("fs").promises,f=new Date(0),h=async({ssoStartUrl:e,ssoSession:s,ssoAccountId:r,ssoRegion:a,ssoRoleName:h,ssoClient:g,clientConfig:p,profile:u,logger:_})=>{let m,k,S="To refresh this SSO session run aws sso login with the corresponding profile.";if(s)try{let e=await ((e={})=>async()=>{let s;e.logger?.debug("@aws-sdk/token-providers - fromSso");let o=await (0,i.YU)(e),r=(0,i.Bz)(e),a=o[r];if(a){if(!a.sso_session)throw new t.Jh(`Profile '${r}' is missing required property 'sso_session'.`)}else throw new t.Jh(`Profile '${r}' could not be found in shared credentials file.`,!1);let h=a.sso_session,g=(await (0,i.qw)(e))[h];if(!g)throw new t.Jh(`Sso session '${h}' could not be found in shared credentials file.`,!1);for(let e of["sso_start_url","sso_region"])if(!g[e])throw new t.Jh(`Sso session '${h}' is missing required property '${e}'.`,!1);g.sso_start_url;let p=g.sso_region;try{s=await (0,i.vf)(h)}catch(e){throw new t.Jh(`The SSO session token associated with profile=${r} was not found or is invalid. ${n}`,!1)}c("accessToken",s.accessToken),c("expiresAt",s.expiresAt);let{accessToken:u,expiresAt:_}=s,m={token:u,expiration:new Date(_)};if(m.expiration.getTime()-Date.now()>3e5)return m;if(Date.now()-f.getTime()<3e4)return d(m),m;c("clientId",s.clientId,!0),c("clientSecret",s.clientSecret,!0),c("refreshToken",s.refreshToken,!0);try{f.setTime(Date.now());let e=await l(s,p);c("accessToken",e.accessToken),c("expiresIn",e.expiresIn);let o=new Date(Date.now()+1e3*e.expiresIn);try{var k;let t;await (k={...s,accessToken:e.accessToken,expiresAt:o.toISOString(),refreshToken:e.refreshToken},t=(0,i.C9)(h),w(t,JSON.stringify(k,null,2)))}catch(e){}return{token:e.accessToken,expiration:o}}catch(e){return d(m),m}})({profile:u})();m={accessToken:e.token,expiresAt:new Date(e.expiration).toISOString()}}catch(e){throw new t.C1(e.message,{tryNextLink:!1,logger:_})}else try{m=await (0,i.vf)(e)}catch(e){throw new t.C1(`The SSO session associated with this profile is invalid. ${S}`,{tryNextLink:!1,logger:_})}if(new Date(m.expiresAt).getTime()-Date.now()<=0)throw new t.C1(`The SSO session associated with this profile has expired. ${S}`,{tryNextLink:!1,logger:_});let{accessToken:y}=m,{SSOClient:x,GetRoleCredentialsCommand:T}=await o.e("709").then(o.bind(o,"../../../node_modules/.pnpm/@aws-sdk+credential-provider-sso@3.651.1_@aws-sdk+client-sso-oidc@3.651.1_@aws-sdk+client-sts@3.651.1_/node_modules/@aws-sdk/credential-provider-sso/dist-es/loadSso.js")),C=g||new x(Object.assign({},p??{},{region:p?.region??a}));try{k=await C.send(new T({accountId:r,roleName:h,accessToken:y}))}catch(e){throw new t.C1(e,{tryNextLink:!1,logger:_})}let{roleCredentials:{accessKeyId:O,secretAccessKey:$,sessionToken:v,expiration:I,credentialScope:N,accountId:D}={}}=k;if(!O||!$||!v||!I)throw new t.C1("SSO returns an invalid temporary credential.",{tryNextLink:!1,logger:_});return{accessKeyId:O,secretAccessKey:$,sessionToken:v,expiration:new Date(I),...N&&{credentialScope:N},...D&&{accountId:D}}},g=(e={})=>async()=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:s,ssoAccountId:o,ssoRegion:n,ssoRoleName:r,ssoSession:a}=e,{ssoClient:l}=e,d=(0,i.Bz)(e);if(s||o||n||r||a)if(s&&o&&n&&r)return h({ssoStartUrl:s,ssoSession:a,ssoAccountId:o,ssoRegion:n,ssoRoleName:r,ssoClient:l,clientConfig:e.clientConfig,profile:d});else throw new t.C1('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});{let o=(await (0,i.YU)(e))[d];if(!o)throw new t.C1(`Profile ${d} was not found.`,{logger:e.logger});if(!(o&&("string"==typeof o.sso_start_url||"string"==typeof o.sso_account_id||"string"==typeof o.sso_session||"string"==typeof o.sso_region||"string"==typeof o.sso_role_name)))throw new t.C1(`Profile ${d} is not configured with SSO credentials.`,{logger:e.logger});if(o?.sso_session){let r=(await (0,i.qw)(e))[o.sso_session],a=` configurations in profile ${d} and sso-session ${o.sso_session}`;if(n&&n!==r.sso_region)throw new t.C1("Conflicting SSO region"+a,{tryNextLink:!1,logger:e.logger});if(s&&s!==r.sso_start_url)throw new t.C1("Conflicting SSO start_url"+a,{tryNextLink:!1,logger:e.logger});o.sso_region=r.sso_region,o.sso_start_url=r.sso_start_url}let{sso_start_url:r,sso_account_id:a,sso_region:c,sso_role_name:w,sso_session:f}=((e,s)=>{let{sso_start_url:o,sso_account_id:i,sso_region:n,sso_role_name:r}=e;if(!o||!i||!n||!r)throw new t.C1(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:s});return e})(o,e.logger);return h({ssoStartUrl:r,ssoSession:f,ssoAccountId:a,ssoRegion:c,ssoRoleName:w,ssoClient:l,clientConfig:e.clientConfig,profile:d})}}}};